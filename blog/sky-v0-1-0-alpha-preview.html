<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Sky v0.1.0 Alpha Preview</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="/javascripts/all.js" type="text/javascript"></script>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- start Mixpanel --><script type="text/javascript">(function(c,a){window.mixpanel=a;var b,d,h,e;b=c.createElement("script");b.type="text/javascript";b.async=!0;b.src=("https:"===c.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.1.min.js';d=c.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d);a._i=[];a.init=function(b,c,f){function d(a,b){var c=b.split(".");2==c.length&&(a=a[c[0]],b=c[1]);a[b]=function(){a.push([b].concat(Array.prototype.slice.call(arguments,0)))}}var g=a;"undefined"!==typeof f?
    g=a[f]=[]:f="mixpanel";g.people=g.people||[];h="disable track track_pageview track_links track_forms register register_once unregister identify name_tag set_config people.identify people.set people.increment".split(" ");for(e=0;e<h.length;e++)d(g,h[e]);a._i.push([b,c,f])};a.__SV=1.1})(document,window.mixpanel||[]);
    mixpanel.init("1850ed6410633e417230028ead53da0f");</script><!-- end Mixpanel -->
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', "UA-34296486-1"]);


  _gaq.push(['_trackPageview']);
  _gaq.push(['_trackPageLoadTime']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script></head>

  

  <body class="blog blog_sky-v0-1-0-alpha-preview">
    <div class="container">
      <div class="row">
        <div class="span8 offset2">
          <header>
            <h1>
              <a href="/">Sky Blog</a>
              <small class="hidden-phone">Behavioral Data</small>

              <ul class="nav nav-pills pull-right" style="font-size:14px; margin-top:3px">
                <li class="active">
                  <a href="/"><i class="icon-share-alt"></i></a>
                </li>
              </ul>
            </h1>
          </header>
        </div>
      </div>

      <div class="row">
        <div class="span8 offset2">
          <hr class="soften">
        </div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="span8 offset2">
          
            <h2>Sky v0.1.0 Alpha Preview</h2>
          
          <h3 id='overview'>Overview</h3>

<p>The hardest part about any software project is getting to a minimum viable product. There are many pieces that have to fit together to make even the basics of the program function. However, once the basics work it is easy to iterate quickly and add new features.</p>

<p>Today the Sky database is being released as an alpha preview. The data store and the language are both working end-to-end and can be used for basic behavioral analytics. I&#8217;d like to give you an overview of where Sky is at now and what the next steps are.</p>

<h3 id='where_its_at'>Where It&#8217;s At</h3>

<p>At the heart of Sky is a simple idea: give people the ability to understand how things behave and then make decisions based on that understanding. The database stores actions and state about things. That&#8217;s all. Simplicity is a basic principle of Sky. Too many other databases try to do too much.</p>

<p>Simplicity may sound limiting though. There are many ways to analyze data so Sky is built with a flexible processing language called Qip (pronounced &#8216;quip&#8217;). Qip allows you to perform complex analytics but is run next to the data it analyzes so it is blazingly fast.</p>

<h3 id='intro_to_qip'>Intro to Qip</h3>

<p>I&#8217;ll be adding documentation for the Qip language as it formalizes but I wanted to give you a short introduction. Here&#8217;s a quick list of high level features:</p>

<ul>
<li>Qip looks like Java but feels like C.</li>

<li>Strongly typed, class-based language (but has no inheritance).</li>

<li>It works entirely on stack-based memory to keep it extremely fast.</li>

<li>LLVM-backed so it runs at C speed.</li>

<li>JIT compiled at runtime.</li>

<li>Explicit support for interfacing with C libraries.</li>
</ul>

<h4 id='example_source'>Example Source</h4>

<p>It&#8217;s probably best to give you a short example of how you might use Qip to analyze something like clickstream data. Here&#8217;s a short example of analyzing the number of hits each page on your web site received:</p>
<pre class='prettyprint' style='margin-bottom:9px;'>
[Hashable("actionId")]
class Result {
  public Int actionId;
  public Int count;
}

Cursor cursor = path.events();
for each(Event event in cursor) {
  Result result = data.get(event.actionId);
  result.count = result.count + 1;
}
</pre>
<h4 id='example_walkthrough'>Example Walkthrough</h4>

<p>Let&#8217;s take this example step by step:</p>

<ol>
<li>
<p>We declare a class called <code>Result</code> that will store our data. We mark it as <code>Hashable</code> so that we can store it in a hash map. The class contains an <code>actionId</code> which stores which action we&#8217;re storing a hit count for and a <code>count</code> property which stores the actual hit count.</p>
</li>

<li>
<p>Qip programs are executed within the context of a single path of events. A path is simply a list of ordered events that occur for, in our case, a user on our web site. The <code>path</code> variable is passed to our program each time it executes and the program will execute once for each user on our web site. The result data is carried over across each iteration so we can maintain our hit count.</p>
</li>

<li>
<p>Once we have the <code>cursor</code> we can use it to loop over the events in our <code>path</code>. For each event in our cursor we grab a <code>Result</code> from our hash map called <code>data</code>. The <code>data</code> variable is similar to <code>path</code> in that it is passed in implicitly. The variable is of type <code>Map&lt;Int,Result&gt;</code> meaning that it is a hash map with an integer key (we use <code>actionId</code>) matching a <code>Result</code> value. The Qip hash map will retrieve an existing <code>Result</code> object if one already exists or will build a new one if it doesn&#8217;t.</p>
</li>

<li>
<p>Finally we simple increment the <code>count</code> for each <code>actionId</code> found.</p>
</li>
</ol>

<h4 id='where_does_the_data_go'>Where Does the Data Go?</h4>

<p>Below is a diagram of how queries and data flow through Sky. The client starts by sending a query to the server where it gets parsed and compiled by the Query Compiler. Next, the compiled module is passed to the Query Engine where it runs it for each path retrieved from the the Path Iterator. Finally, once all paths are exhausted, the results are passed to the serializer which converts everything to <a href='http://msgpack.org/'>MessagePack</a> format and the data is returned to the client.</p>
<center>
  <img src='/images/sky-v1.0.0-alpha-preview/qip_flow.png' />
</center>
<p>This flow allows you to easily integrate with any language that supports MessagePack (C, Java, PHP, JavaScript, Go, etc) and it ensures that you are not limited by any particular data structure provided by Sky.</p>

<h4 id='plugin_architecture'>Plugin Architecture</h4>

<p>Because Qip is a fairly simple language it was an explicit goal to make integration of external code as easy as possible. There are so many great data processing libraries for machine learning and classification that I wanted to be able to pull from. To integrate an external call, simply add an <code>[External]</code> metadata tag to the class method.</p>
<pre class='prettyprint' style='margin-bottom:9px;'>
class SentimentAnalyzer {
  [External(name="my_analyzer_function")]
  public String analyze(String string);
}

SentimentAnalyzer analyzer;
analyzer.analyze(some_text);
</pre>
<p>This example here will call out to the following C function:</p>
<pre class='prettyprint' style='margin-bottom:9px;'>
struct sentiment_analyzer_t {
  ...
};

char *my_analyzer_function(struct sentiment_analyzer *analyzer, char *string);
</pre>
<h3 id='roadmap'>Roadmap</h3>

<p>The alpha preview is still a rough cut. The next steps are to stabilize the server, API and the language. After that some additional language features will be added to make queries simpler and easier. A declarative syntax will be layered on top of the Qip procedural form that will change the web page hit query to this:</p>
<pre class='prettyprint' style='margin-bottom:9px;'>
data.map(path, :count++);
</pre>
<p>I&#8217;ll be writing more about the declarative syntax as it gets finalized.</p>

<p>After Qip improvements, Sky will be adding real-time queries meaning that you can submit the query above and retrieve not only the results back but also a continuous stream of delta updates as new events come into the server and match your query. This is useful not only in analytics but also can be used for real-time risk analysis or to analyze purchase intent of a customer while they&#8217;re clicking through your web site.</p>

<p>Finally, Sky will be adding multicore and multinode distributed processing. A single threaded Sky server can already analyze tens of millions of events per second. However, sometimes you need to analyze billions of events per second.</p>

<p>Some exciting things are coming. Please visit the <a href='https://github.com/skydb/sky'>Sky GitHub project page</a> to contribute. Or join the mailing list by sending an e-mail to <a href='mailto:sky@librelist.com'>sky@librelist.com</a> to get updates.<br /><br /></p>

<p><a href='http://news.ycombinator.com/item?id=4409506'>Discuss this post on Hacker News</a></p>
        </div>
      </div>
    </div><!-- /container -->
    
    <div class="container">
      <div class="row">
        <div class="span8 offset2">
          <hr class="soften" style="margin:20px 0px">

          <div id="disqus_thread"></div>
          <script type="text/javascript">
              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
              var disqus_shortname = 'skydb'; // required: replace example with your forum shortname

              /* * * DON'T EDIT BELOW THIS LINE * * */
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                
        </div>
      </div>
    </div><!-- /container -->
    
    <footer>
    </footer>
  </body>
</html>
